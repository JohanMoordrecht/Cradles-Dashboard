<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Artikel Formulier</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:Segoe UI,sans-serif;background:#fff;padding:20px;min-height:100vh}
    .container{max-width:900px;margin:0 auto;background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);overflow:hidden}
    .header{background:#fff;color:#E30613;padding:25px;text-align:center}
    .header h1{font-size:26px;margin-bottom:6px}
    .form-content{padding:30px}
    .form-group{margin-bottom:20px}
    .form-row{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    label{display:block;font-weight:600;color:#333;margin-bottom:6px;font-size:14px}
    input,select,textarea{width:100%;padding:11px;border:2px solid #e0e0e0;border-radius:6px;font-size:14px;background:#fff;box-shadow:inset 0 1px 2px rgba(0,0,0,.04);transition:border-color .2s}
    input:focus,select:focus,textarea:focus{outline:none;border-color:#8B9F1C;box-shadow:0 0 0 3px rgba(139,159,28,.15)}
    .section-title{font-size:17px;font-weight:700;color:#8B9F1C;margin:28px 0 16px;padding-bottom:8px;border-bottom:2px solid #8B9F1C}
    .helper-text{font-size:12px;color:#666;margin-top:4px}
    .button-group{display:flex;gap:12px;margin-top:30px}
    button{flex:1;padding:13px;border:none;border-radius:6px;font-size:15px;font-weight:600;cursor:pointer;transition:all .2s}
    .btn-primary{background:#E30613;color:#fff}
    .btn-primary:hover{background:#b00510}
    .btn-secondary{background:#f0f0f0;color:#333}
    .btn-secondary:hover{background:#e0e0e0}
    .btn-print{background:#10b981;color:#fff}
    .btn-print:hover{background:#059669}
    .error{color:#c00;font-size:12px;margin-top:4px;display:none}
    
    @media print{
      @page{size:A4;margin:10mm}
      body{background:#fff;padding:0;margin:0}
      .container{box-shadow:none;border-radius:0;margin:0}
      .button-group{display:none}
      input,select,textarea{border:1px solid #333;background:#fff;color:#000;font-size:11pt;padding:6px}
      .section-title{color:#8B9F1C;border-bottom:1px solid #8B9F1C}
      .error{display:none}
    }
    @media (max-width:768px){.form-row{grid-template-columns:1fr}}
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>ARTIKEL FORMULIER</h1>
    <p id="lastMod" style="display:none">Laatste wijziging: —</p>
  </div>
  
  <div class="form-content">
    <form id="f">
      <div class="form-group">
        <label for="d">Datum</label>
        <input type="date" id="d" required>
      </div>
      <div class="form-group">
        <label for="n">Naam</label>
        <input type="text" id="n" required>
      </div>
      <div class="form-group">
        <label for="a">Artikelnummer</label>
        <input type="text" id="a" required>
      </div>

      <div class="section-title">Verpakking</div>
      <div class="form-row">
        <div class="form-group">
          <label for="se">Scanner eenheid</label>
          <select id="se" required>
            <option value="">—</option>
            <option value="rol">Rol</option>
            <option value="sheet">Sheet</option>
            <option value="box">Box</option>
            <option value="meters">Meters</option>
            <option value="kilos">Kilo's</option>
            <option value="pack">Pack</option>
          </select>
        </div>
        <div class="form-group">
          <label for="vi">Verpakt in</label>
          <select id="vi" required>
            <option value="">—</option>
            <option value="doos">Doos</option>
            <option value="folie">Folie</option>
            <option value="koker">Koker</option>
            <option value="box">Box</option>
          </select>
        </div>
      </div>
      <div class="form-group">
        <label for="vp">Volume op pallet</label>
        <input type="number" id="vp" min="0">
      </div>

      <div class="section-title">Afmetingen</div>
      <div class="form-group">
        <label for="cf">Collo formaat (L×B×H cm)</label>
        <input type="text" id="cf" required placeholder="bijv. 40×30×25">
        <div class="helper-text">Koker: Lengte × Ø</div>
      </div>
      <div class="form-group">
        <label for="pf">Volle pallet (L×B×H cm)</label>
        <input type="text" id="pf" placeholder="120×80×140">
      </div>
      <div class="form-group">
        <label for="st">Stapelbaar</label>
        <input type="text" id="st" placeholder="bijv. 5 lagen / 24 per laag">
      </div>

      <div class="section-title">Gewicht</div>
      <div class="form-row">
        <div class="form-group">
          <label for="cg">Colli gewicht (kg)</label>
          <input type="number" step="0.01" min="0" id="cg" required>
        </div>
        <div class="form-group">
          <label for="pg">Pallet gewicht (kg)</label>
          <input type="number" step="0.01" min="0" id="pg">
        </div>
      </div>

      <div class="form-group">
        <label for="op">Opmerkingen</label>
        <textarea id="op" rows="3"></textarea>
      </div>

      <div class="button-group">
        <button type="button" class="btn-secondary" id="rst">Reset</button>
        <button type="button" class="btn-print" id="ple">Print leeg</button>
        <button type="button" class="btn-print" id="pif">Print ingevuld</button>
      </div>
    </form>
  </div>
</div>

<script>
const els = {
  d: document.getElementById('d'),
  n: document.getElementById('n'),
  a: document.getElementById('a'),
  se: document.getElementById('se'),
  vi: document.getElementById('vi'),
  vp: document.getElementById('vp'),
  cf: document.getElementById('cf'),
  pf: document.getElementById('pf'),
  st: document.getElementById('st'),
  cg: document.getElementById('cg'),
  pg: document.getElementById('pg'),
  op: document.getElementById('op'),
  lastMod: document.getElementById('lastMod')
};

const defaults = {
  d: new Date().toISOString().slice(0,10),
  n: '', a: '', se: '', vi: '', vp: '', cf: '', pf: '', st: '', cg: '', pg: '', op: ''
};

function setValues(obj) {
  for (const [k, v] of Object.entries(obj)) {
    if (els[k]) els[k].value = v;
  }
}

function getValues() {
  const data = {};
  for (const k in els) {
    if (els[k]) data[k] = els[k].value;
  }
  return data;
}

function showLastModified() {
  const now = new Date();
  const d = now.toLocaleDateString('nl-NL',{day:'2-digit',month:'2-digit',year:'numeric'});
  const t = now.toLocaleTimeString('nl-NL',{hour:'2-digit',minute:'2-digit'});
  els.lastMod.textContent = `Laatste wijziging: ${d} ${t}`;
  els.lastMod.style.display = 'block';
}

// Init
setValues(defaults);

// Validatie (simpel)
function isValid() {
  let ok = true;
  ['d','n','a','se','vi','cf','cg'].forEach(k => {
    if (!els[k].value.trim()) {
      els[k].style.borderColor = '#c00';
      ok = false;
    } else {
      els[k].style.borderColor = '#e0e0e0';
    }
  });
  if (els.cg.value && +els.cg.value <= 0) ok = false;
  return ok;
}

// Events
document.getElementById('f').addEventListener('submit', e => {
  e.preventDefault();
  if (!isValid()) return alert('Vul alle verplichte velden in (rood gemarkeerd).');
  
  localStorage.setItem('artikel', JSON.stringify(getValues()));
  showLastModified();
  alert('Opgeslagen in localStorage');
});

document.getElementById('rst').onclick = () => {
  if (!confirm('Reset formulier?')) return;
  setValues(defaults);
  els.lastMod.style.display = 'none';
  document.querySelectorAll('input,select').forEach(el => el.style.borderColor = '#e0e0e0');
};

document.getElementById('pif').onclick = () => window.print();

document.getElementById('ple').onclick = () => {
  const vals = getValues();
  setValues(defaults);
  window.print();
  setTimeout(() => setValues(vals), 300); // fallback
  window.onafterprint = () => { setValues(vals); window.onafterprint = null; };
};

// Simpele barcode support
let buf = '';
document.addEventListener('keydown', e => {
  if (!['INPUT','SELECT','TEXTAREA'].includes(document.activeElement.tagName)) return;
  if (e.key === 'Enter' && buf.length > 3) {
    document.activeElement.value = buf;
    document.activeElement.dispatchEvent(new Event('input'));
    buf = '';
    e.preventDefault();
  } else if (e.key.length === 1) {
    buf += e.key;
    clearTimeout(window.bufTimer);
    window.bufTimer = setTimeout(() => buf = '', 180);
  }
});
</script>
</body>
</html>